<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dtstack.rdos.engine.db.mapper.RdosPluginInfoMapper">
	
	<resultMap id="rdosPluginInfoResult" type="com.dtstack.rdos.engine.db.dataobject.RdosPluginInfo">
        <id column="id" property="id" jdbcType="BIGINT" />
        <result column="plugin_key" property="pluginKey" jdbcType="VARCHAR"/>
        <result column="plugin_info" property="pluginInfo" jdbcType="VARCHAR"/>
        <result column="type" property="isDeleted" jdbcType="INTEGER" />
        <result column="gmt_create" property="gmtCreate" jdbcType="TIMESTAMP" />
        <result column="gmt_modified" property="gmtModified" jdbcType="TIMESTAMP" />
        <result column="is_deleted" property="isDeleted" jdbcType="INTEGER" />
    </resultMap>
	
   <insert id="replaceInto" parameterType="java.util.HashMap" >
	   replace into rdos_plugin_info(plugin_key, plugin_info, type, gmt_create,gmt_modified)
	   values(#{pluginKey}, #{pluginInfo}, #{type} now(),now())

       <selectKey resultType="long" keyProperty="id" order="AFTER">
           SELECT LAST_INSERT_ID() AS ID
       </selectKey>
   </insert>

    <select id="getByKey" resultMap="rdosPluginInfoResult">
        select * from rdos_plugin_info where plugin_key = #{stage} and is_deleted=0
    </select>

    <select id="getPluginInfo" resultType="java.lang.String">
        select plugin_info from rdos_plugin_info where id = #{id} and is_deleted = 0
    </select>

</mapper>
